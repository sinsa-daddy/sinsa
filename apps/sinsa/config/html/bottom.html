<!-- 注册 Service Worker -->
<script type="module">
  import { Workbox } from 'https://registry.npmmirror.com/workbox-window/7.0.0/files/build/workbox-window.prod.mjs';
  if ('serviceWorker' in navigator && location.host !== 'localhost:8080') {
    const wb = new Workbox('/sw.js');

    window.$subscribeTermsUpdate = new Promise(resolve => {
      wb.addEventListener('message', event => {
        if (event.data.type === 'TERMS_UPDATE') {
          resolve(event.data.payload);
        }
      });
    });

    wb.register();
  }
</script>

<!-- Google Tag Manager (noscript) -->
<noscript
  ><iframe
    src="https://www.googletagmanager.com/ns.html?id=GTM-KTXBFPRH"
    height="0"
    width="0"
    style="display: none; visibility: hidden"
  ></iframe
></noscript>
<!-- End Google Tag Manager (noscript) -->
